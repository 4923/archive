---
keywords: HAR, benchmark dataset, NTU RGB+D, NTU RGB+D 120
description: 정성평가를 위한 Plotting
title: "skeleton data plotting (for NTU RGB)"
toc: true
branch: master
badges: true
comments: true
categories: [HAR, benchmark dataset, NTU RGB+D]
permalink: /ntu-skl-plotting/
nb_path: _notebooks/2022-12-29-ntu-skl-plotting.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-12-29-ntu-skl-plotting.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pwd
<span class="o">!</span>ls
<span class="o">!</span><span class="nb">cd</span> ntu_utils/parser_repo<span class="p">;</span> ls<span class="p">;</span> git remote -v
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/devin/wdir/datasets/utils
mmskeleton  ntu_utils  plotting  plotting.ipynb  working.ipynb
conf.py  __pycache__  README.md  read_skeleton.py  utils.py
origin	https://github.com/Ugenteraan/NTU-RGB-Skeleton-Python.git (fetch)
origin	https://github.com/Ugenteraan/NTU-RGB-Skeleton-Python.git (push)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="c1"># basic data handling tools</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># image processing</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">imageio</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>

<span class="c1"># Modules</span>
<span class="kn">from</span> <span class="nn">ntu_utils.parser_repo.read_skeleton</span> <span class="kn">import</span> <span class="n">read_skeleton</span>
<span class="c1"># 원래 용법대로 사용하면 가져와서 쓸 수가 없어서 import 해서 쓸 수 있도록 변경</span>
<span class="c1"># !cd parser_repo; ls; python3 read_skeleton.py --skel=&quot;/home/devin/wdir/datasets/NTU_RGB+D/1_NTU-RGB+D/1_3DSkeletons/nturgb+d_skeletons/S001C001P001R001A001.skeleton&quot; --save</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">GLOBAL VARIABLE</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">args</span><span class="p">:</span>
    <span class="c1"># wdir/datasets/NTU_RGB+D/1_NTU-RGB+D/1_3DSkeletons/nturgb+d_skeletons/S001C001P001R001A001.skeleton</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;S001C001P001R001A002&quot;</span>
    <span class="n">skel_raw</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../NTU_RGB+D/1_NTU-RGB+D/1_3DSkeletons/nturgb+d_skeletons/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.skeleton&quot;</span>
    <span class="n">skel_processed_sub</span> <span class="o">=</span> <span class="s2">&quot;../processed/st-gcn-processed-data/NTU-RGB-D/xsub/train_data.npy&quot;</span>
    <span class="n">skel_processed_view</span> <span class="o">=</span> <span class="s2">&quot;../processed/st-gcn-processed-data/NTU-RGB-D/xview/train_data.npy&quot;</span>
    <span class="n">subject_ID</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">video</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">save</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">SAMPLE</span> <span class="o">=</span> <span class="n">read_skeleton</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># args : class, global variable</span>
<span class="n">SAMPLE_NUMBER</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>

<span class="c1"># {color_name(str) : (color code B,G,R)}</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;blue&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,),</span>
    <span class="s1">&#39;green&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">&#39;red&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
    <span class="s1">&#39;white&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
    <span class="s1">&#39;black&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,),</span>
    <span class="s1">&#39;cyan&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span>
    <span class="s1">&#39;magenta&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span>
    <span class="s1">&#39;yellow&#39;</span> <span class="p">:</span> 	<span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># {joint_name(str) : int}</span>
<span class="n">joint_annotations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;base of spine&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;middle of spine&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;neck&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;head&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;left shoulder&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;left elbow&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;left wrist&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s2">&quot;left hand&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;right shoulder&quot;</span> <span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;right elbow&quot;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;right wrist&quot;</span> <span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;right hand&quot;</span> <span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s2">&quot;left hip&quot;</span> <span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="s2">&quot;left knee&quot;</span> <span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;left ankle&quot;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;left foot&quot;</span> <span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s2">&quot;right hip&quot;</span> <span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;right knee&quot;</span> <span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="s2">&quot;right ankle&quot;</span> <span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s2">&quot;right foot&quot;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;spine&quot;</span> <span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;tip of left hand&quot;</span> <span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;left thumb&quot;</span> <span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
    <span class="s2">&quot;tip of right hand&quot;</span> <span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
    <span class="s2">&quot;right thumb&quot;</span><span class="p">:</span> <span class="mi">25</span>
<span class="p">}</span>

<span class="c1"># {int : labels(str)}</span>
<span class="n">ntu_label_annotations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span>   <span class="p">:</span>  <span class="s2">&quot;drink water&quot;</span><span class="p">,</span>
    <span class="mi">2</span>   <span class="p">:</span>  <span class="s2">&quot;eat meal/snack&quot;</span><span class="p">,</span>
    <span class="mi">3</span>   <span class="p">:</span>  <span class="s2">&quot;brushing teeth&quot;</span><span class="p">,</span>
    <span class="mi">4</span>   <span class="p">:</span>  <span class="s2">&quot;brushing hair&quot;</span><span class="p">,</span>
    <span class="mi">5</span>   <span class="p">:</span>  <span class="s2">&quot;drop&quot;</span><span class="p">,</span>
    <span class="mi">6</span>   <span class="p">:</span>  <span class="s2">&quot;pickup&quot;</span><span class="p">,</span>
    <span class="mi">7</span>   <span class="p">:</span>  <span class="s2">&quot;throw&quot;</span><span class="p">,</span>
    <span class="mi">8</span>   <span class="p">:</span>  <span class="s2">&quot;sitting down&quot;</span><span class="p">,</span>
    <span class="mi">9</span>   <span class="p">:</span>  <span class="s2">&quot;standing up (from sitting position)&quot;</span><span class="p">,</span>
    <span class="mi">10</span>  <span class="p">:</span>  <span class="s2">&quot;clapping&quot;</span><span class="p">,</span>
    <span class="mi">11</span>  <span class="p">:</span>  <span class="s2">&quot;reading&quot;</span><span class="p">,</span>
    <span class="mi">12</span>  <span class="p">:</span>  <span class="s2">&quot;writing&quot;</span><span class="p">,</span>
    <span class="mi">13</span>  <span class="p">:</span>  <span class="s2">&quot;tear up paper&quot;</span><span class="p">,</span>
    <span class="mi">14</span>  <span class="p">:</span>  <span class="s2">&quot;wear jacket&quot;</span><span class="p">,</span>
    <span class="mi">15</span>  <span class="p">:</span>  <span class="s2">&quot;take off jacket&quot;</span><span class="p">,</span>
    <span class="mi">16</span>  <span class="p">:</span>  <span class="s2">&quot;wear a shoe&quot;</span><span class="p">,</span>
    <span class="mi">17</span>  <span class="p">:</span>  <span class="s2">&quot;take off a shoe&quot;</span><span class="p">,</span>
    <span class="mi">18</span>  <span class="p">:</span>  <span class="s2">&quot;wear on glasses&quot;</span><span class="p">,</span>
    <span class="mi">19</span>  <span class="p">:</span>  <span class="s2">&quot;take off glasses&quot;</span><span class="p">,</span>
    <span class="mi">20</span>  <span class="p">:</span>  <span class="s2">&quot;put on a hat/cap&quot;</span><span class="p">,</span>
    <span class="mi">21</span>  <span class="p">:</span>  <span class="s2">&quot;take off a hat/cap&quot;</span><span class="p">,</span>
    <span class="mi">22</span>  <span class="p">:</span>  <span class="s2">&quot;cheer up&quot;</span><span class="p">,</span>
    <span class="mi">23</span>  <span class="p">:</span>  <span class="s2">&quot;hand waving&quot;</span><span class="p">,</span>
    <span class="mi">24</span>  <span class="p">:</span>  <span class="s2">&quot;kicking something&quot;</span><span class="p">,</span>
    <span class="mi">25</span>  <span class="p">:</span>  <span class="s2">&quot;reach into pocket&quot;</span><span class="p">,</span>
    <span class="mi">26</span>  <span class="p">:</span>  <span class="s2">&quot;hopping (one foot jumping)&quot;</span><span class="p">,</span>
    <span class="mi">27</span>  <span class="p">:</span>  <span class="s2">&quot;jump up&quot;</span><span class="p">,</span>
    <span class="mi">28</span>  <span class="p">:</span>  <span class="s2">&quot;make a phone call/answer phone&quot;</span><span class="p">,</span>
    <span class="mi">29</span>  <span class="p">:</span>  <span class="s2">&quot;playing with phone/tablet&quot;</span><span class="p">,</span>
    <span class="mi">30</span>  <span class="p">:</span>  <span class="s2">&quot;typing on a keyboard&quot;</span><span class="p">,</span>
    <span class="mi">31</span>  <span class="p">:</span>  <span class="s2">&quot;pointing to something with finger&quot;</span><span class="p">,</span>
    <span class="mi">32</span>  <span class="p">:</span>  <span class="s2">&quot;taking a selfie&quot;</span><span class="p">,</span>
    <span class="mi">33</span>  <span class="p">:</span>  <span class="s2">&quot;check time (from watch)&quot;</span><span class="p">,</span>
    <span class="mi">34</span>  <span class="p">:</span>  <span class="s2">&quot;rub two hands together&quot;</span><span class="p">,</span>
    <span class="mi">35</span>  <span class="p">:</span>  <span class="s2">&quot;nod head/bow&quot;</span><span class="p">,</span>
    <span class="mi">36</span>  <span class="p">:</span>  <span class="s2">&quot;shake head&quot;</span><span class="p">,</span>
    <span class="mi">37</span>  <span class="p">:</span>  <span class="s2">&quot;wipe face&quot;</span><span class="p">,</span>
    <span class="mi">38</span>  <span class="p">:</span>  <span class="s2">&quot;salute&quot;</span><span class="p">,</span>
    <span class="mi">39</span>  <span class="p">:</span>  <span class="s2">&quot;put the palms together&quot;</span><span class="p">,</span>
    <span class="mi">40</span>  <span class="p">:</span>  <span class="s2">&quot;cross hands in front (say stop)&quot;</span><span class="p">,</span>
    <span class="mi">41</span>  <span class="p">:</span>  <span class="s2">&quot;sneeze/cough&quot;</span><span class="p">,</span>
    <span class="mi">42</span>  <span class="p">:</span>  <span class="s2">&quot;staggering&quot;</span><span class="p">,</span>
    <span class="mi">43</span>  <span class="p">:</span>  <span class="s2">&quot;falling&quot;</span><span class="p">,</span>
    <span class="mi">44</span>  <span class="p">:</span>  <span class="s2">&quot;touch head (headache)&quot;</span><span class="p">,</span>
    <span class="mi">45</span>  <span class="p">:</span>  <span class="s2">&quot;touch chest (stomachache/heart pain)&quot;</span><span class="p">,</span>
    <span class="mi">46</span>  <span class="p">:</span>  <span class="s2">&quot;touch back (backache)&quot;</span><span class="p">,</span>
    <span class="mi">47</span>  <span class="p">:</span>  <span class="s2">&quot;touch neck (neckache)&quot;</span><span class="p">,</span>
    <span class="mi">48</span>  <span class="p">:</span>  <span class="s2">&quot;nausea or vomiting condition&quot;</span><span class="p">,</span>
    <span class="mi">49</span>  <span class="p">:</span>  <span class="s2">&quot;use a fan (with hand or paper)/feeling warm&quot;</span><span class="p">,</span>
    <span class="mi">50</span>  <span class="p">:</span>  <span class="s2">&quot;punching/slapping other person&quot;</span><span class="p">,</span>
    <span class="mi">51</span>  <span class="p">:</span>  <span class="s2">&quot;kicking other person&quot;</span><span class="p">,</span>
    <span class="mi">52</span>  <span class="p">:</span>  <span class="s2">&quot;pushing other person&quot;</span><span class="p">,</span>
    <span class="mi">53</span>  <span class="p">:</span>  <span class="s2">&quot;pat on back of other person&quot;</span><span class="p">,</span>
    <span class="mi">54</span>  <span class="p">:</span>  <span class="s2">&quot;point finger at the other person&quot;</span><span class="p">,</span>
    <span class="mi">55</span>  <span class="p">:</span>  <span class="s2">&quot;hugging other person&quot;</span><span class="p">,</span>
    <span class="mi">56</span>  <span class="p">:</span>  <span class="s2">&quot;giving something to other person&quot;</span><span class="p">,</span>
    <span class="mi">57</span>  <span class="p">:</span>  <span class="s2">&quot;touch other person&#39;s pocket&quot;</span><span class="p">,</span>
    <span class="mi">58</span>  <span class="p">:</span>  <span class="s2">&quot;handshaking&quot;</span><span class="p">,</span>
    <span class="mi">59</span>  <span class="p">:</span>  <span class="s2">&quot;walking towards each other&quot;</span><span class="p">,</span>
    <span class="mi">60</span>  <span class="p">:</span>  <span class="s2">&quot;walking apart from each other&quot;</span><span class="p">,</span>
    <span class="mi">61</span>  <span class="p">:</span>  <span class="s2">&quot;put on headphone&quot;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Data has </span><span class="si">{</span><span class="n">SAMPLE</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span><span class="si">}</span><span class="s2"> keys&quot;</span><span class="p">)</span>        <span class="c1"># frame이 각각 다른 것 같음 </span>
<span class="n">joint_number</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">if</span> <span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">joint_number</span><span class="p">)]</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">==</span> <span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">joint_number</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="fm">__len__</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Each key has </span><span class="si">{</span><span class="n">SAMPLE</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span><span class="si">}</span><span class="s2"> values : joints&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sample Data has 158 keys
Each key has 25 values : joints
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">extract_coordinates</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span> <span class="n">target_joint</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">joint_annotations</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="n">joint_annotations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args : </span>
<span class="sd">        - data : dictionary type, skeleton extension raw NTU120 data</span>
<span class="sd">            - keys : total SAMPLE.keys().__len__() length, MUST be string   / length is not fixed</span>
<span class="sd">            - each key has 25 indexes which represents 25 joints</span>
<span class="sd">            - each key has 3 data which represents coordinate dimension: X, Y, (Z)</span>
<span class="sd">        - target_joint : configuration joint of ntu set (exact name)</span>
<span class="sd">        - joint_annotation : dictionary, match string &#39;target_joint&#39; into its number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Arguments</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
    <span class="n">dontknow</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># 이중리스트임 [[값]]</span>
    <span class="n">start_frame</span><span class="p">,</span> <span class="n">end_frame</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">joint_number</span> <span class="o">=</span> <span class="n">joint_annotations</span><span class="p">[</span><span class="n">target_joint</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>      <span class="c1"># 0부터 시작하므로</span>

    <span class="c1"># print</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">target_joint</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">next_frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_frame</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;frame no. </span><span class="si">{</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="si">}</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X : </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">X</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y : </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Y</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Z : </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Z</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;base of spine&#39;</span><span class="p">,</span> <span class="s1">&#39;middle of spine&#39;</span><span class="p">,</span> <span class="s1">&#39;head&#39;</span><span class="p">,</span> <span class="s1">&#39;right foot&#39;</span><span class="p">,</span> <span class="s1">&#39;left foot&#39;</span><span class="p">]:</span>
    <span class="n">extract_coordinates</span><span class="p">(</span><span class="n">SAMPLE</span><span class="p">,</span> <span class="n">joint</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================================================
[base of spine]
frame no. 1	 X : 1047.710	Y : 513.642	Z : -0.191
frame no. 11	 X : 1048.290	Y : 513.821	Z : -0.183
frame no. 21	 X : 1048.281	Y : 511.923	Z : -0.216
frame no. 31	 X : 1049.081	Y : 509.494	Z : -0.219
frame no. 41	 X : 1048.423	Y : 512.998	Z : -0.216
frame no. 51	 X : 1048.136	Y : 513.229	Z : -0.224
frame no. 61	 X : 1048.910	Y : 511.708	Z : -0.197
frame no. 71	 X : 1049.379	Y : 512.329	Z : -0.202
frame no. 81	 X : 1049.375	Y : 512.324	Z : -0.237
frame no. 91	 X : 1049.288	Y : 511.088	Z : -0.226
frame no. 101	 X : 1048.591	Y : 510.243	Z : -0.277
frame no. 111	 X : 1048.618	Y : 510.258	Z : -0.298
frame no. 121	 X : 1048.800	Y : 510.808	Z : -0.230
frame no. 131	 X : 1048.711	Y : 511.964	Z : -0.236
frame no. 141	 X : 1049.196	Y : 511.940	Z : -0.268
frame no. 151	 X : 1050.422	Y : 511.508	Z : -0.296
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_label</span><span class="p">(</span><span class="n">sample_number</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="n">SAMPLE_NUMBER</span><span class="p">,</span> <span class="n">ntu_label_annotations</span><span class="o">=</span><span class="n">ntu_label_annotations</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Args:</span>
<span class="sd">        - label: ntu_train_label, (0~59까지의 값:int, skeleton_file_name)</span>

<span class="sd">    # Note: actions labelled from A1 to A60 are contained in &quot;NTU RGB+D&quot; (https://rose1.ntu.edu.sg/dataset/actionRecognition/)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">label_name</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">ntu_label_annotations</span><span class="p">[</span><span class="n">SAMPLE_NUMBER</span><span class="p">]</span>
    <span class="n">label_name_no_blank</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">label_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">label_name_no_blank</span>

<span class="c1"># test </span>
<span class="n">check_label</span><span class="p">(</span><span class="n">sample_number</span><span class="o">=</span><span class="n">SAMPLE_NUMBER</span><span class="p">)</span>   
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;eat_meal_snack&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># target_joints = [&#39;base of spine&#39;, &#39;middle of spine&#39;, &#39;spine&#39;, &#39;head&#39;,&#39;right elbow&#39;, &#39;left elbow&#39;, &#39;tip of left hand&#39;, &#39;tip of right hand&#39;,&#39;right foot&#39;, &#39;left foot&#39;]     # temp selection</span>
<span class="n">target_joints</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;base of spine&#39;</span><span class="p">,</span> <span class="s1">&#39;middle of spine&#39;</span><span class="p">,</span> <span class="s1">&#39;neck&#39;</span><span class="p">,</span> <span class="s1">&#39;head&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;left shoulder&#39;</span><span class="p">,</span> <span class="s1">&#39;left elbow&#39;</span><span class="p">,</span> <span class="s1">&#39;left wrist&#39;</span><span class="p">,</span> <span class="s1">&#39;left hand&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;right shoulder&#39;</span><span class="p">,</span> <span class="s1">&#39;right elbow&#39;</span><span class="p">,</span> <span class="s1">&#39;right wrist&#39;</span><span class="p">,</span> <span class="s1">&#39;right hand&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;left hip&#39;</span><span class="p">,</span> <span class="s1">&#39;left knee&#39;</span><span class="p">,</span> <span class="s1">&#39;left ankle&#39;</span><span class="p">,</span> <span class="s1">&#39;left foot&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;right hip&#39;</span><span class="p">,</span> <span class="s1">&#39;right knee&#39;</span><span class="p">,</span> <span class="s1">&#39;right ankle&#39;</span><span class="p">,</span> <span class="s1">&#39;right foot&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;spine&#39;</span><span class="p">,</span>
                <span class="s1">&#39;tip of left hand&#39;</span><span class="p">,</span> <span class="s1">&#39;left thumb&#39;</span><span class="p">,</span> <span class="s1">&#39;tip of right hand&#39;</span><span class="p">,</span> <span class="s1">&#39;right thumb&#39;</span><span class="p">]</span>     <span class="c1"># full joints (total 25)</span>
<span class="n">start_frame</span><span class="p">,</span> <span class="n">dontknow</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>

<span class="n">joint_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">joint_annotations</span><span class="p">[</span><span class="n">target_joint</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">target_joint</span> <span class="ow">in</span> <span class="n">target_joints</span><span class="p">]</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">X</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span>
<span class="n">Ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Y</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span>
<span class="n">Zs</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Z</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># canvas : [ref](https://bkshin.tistory.com/entry/OpenCV-5-%EC%B0%BD-%EA%B4%80%EB%A6%AC-%EB%B0%8F-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%B2%98%EB%A6%AC)</span>
<span class="n">canvas_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>    <span class="c1"># 임의 지정 가능, video 가 1920 * 1080 이므로 그 기준으로 설정</span>
<span class="n">cation_classes</span> <span class="o">=</span> <span class="mi">120</span>            <span class="c1"># ref: 3.1.2, 82 daily actions, 12 health-related actions, 26 mutual actions</span>
<span class="n">subjects</span> <span class="o">=</span> <span class="mi">106</span>                  <span class="c1"># ref: 3.1.3 106 distinct subject</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">canvas_shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>    <span class="c1"># uint : 부호 없는 정수 or 0을 포함하는 양수로 uint 또는 int 뒤에 오는 숫자는 bit의 개수를 의미한다. (uint8 : 2^8개의 정수 표현 가능, 0~255)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># &#39;base of spine&#39;, &#39;middle of spine&#39;, &#39;spine&#39;, &#39;head&#39;,</span>
<span class="c1"># &#39;right elbow&#39;, &#39;left elbow&#39;, &#39;tip of left hand&#39;, &#39;tip of right hand&#39;,</span>
<span class="c1"># &#39;right foot&#39;, &#39;left foot&#39;</span>
<span class="c1"># &#39;&#39;&#39;</span>

<span class="c1"># base_of_spine     = (int(Xs[0]), int(Ys[0]))  # green</span>
<span class="c1"># middle_of_spine   = (int(Xs[1]), int(Ys[1]))  # blue</span>
<span class="c1"># spine             = (int(Xs[2]), int(Ys[2]))  # green</span>
<span class="c1"># head              = (int(Xs[3]), int(Ys[3]))  # red</span>
<span class="c1"># right_elbow       = (int(Xs[4]), int(Ys[4]))  # yellow</span>
<span class="c1"># left_elbow        = (int(Xs[5]), int(Ys[5]))  # yellow</span>
<span class="c1"># tip_of_left_hand  = (int(Xs[6]), int(Ys[6]))  # magenta</span>
<span class="c1"># tip_of_right_hand = (int(Xs[7]), int(Ys[7]))  # magenta</span>
<span class="c1"># right_foot        = (int(Xs[8]), int(Ys[8]))  # cyan</span>
<span class="c1"># left_foot         = (int(Xs[9]), int(Ys[9]))  # cyan</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">draw_line_10</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">):</span>
    <span class="c1">## Params</span>
    <span class="n">base_of_spine</span>     <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># green</span>
    <span class="n">middle_of_spine</span>   <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># blue</span>
    <span class="n">spine</span>             <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># green</span>
    <span class="n">head</span>              <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>  <span class="c1"># red</span>
    <span class="n">right_elbow</span>       <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>  <span class="c1"># yellow</span>
    <span class="n">left_elbow</span>        <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>  <span class="c1"># yellow</span>
    <span class="n">tip_of_left_hand</span>  <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>  <span class="c1"># magenta</span>
    <span class="n">tip_of_right_hand</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>  <span class="c1"># magenta</span>
    <span class="n">right_foot</span>        <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>  <span class="c1"># cyan</span>
    <span class="n">left_foot</span>         <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span>  <span class="c1"># cyan</span>
    
    
    <span class="c1">## line</span>
    <span class="n">custom_thick</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">base_of_spine</span><span class="p">,</span>    <span class="n">pt2</span><span class="o">=</span><span class="n">middle_of_spine</span><span class="p">,</span>    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">],</span>      <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">middle_of_spine</span><span class="p">,</span>  <span class="n">pt2</span><span class="o">=</span><span class="n">spine</span><span class="p">,</span>              <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">],</span>       <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">spine</span><span class="p">,</span>            <span class="n">pt2</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>               <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>        <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">spine</span><span class="p">,</span>            <span class="n">pt2</span><span class="o">=</span><span class="n">right_elbow</span><span class="p">,</span>        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">],</span>       <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">spine</span><span class="p">,</span>            <span class="n">pt2</span><span class="o">=</span><span class="n">left_elbow</span><span class="p">,</span>         <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">],</span>       <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">right_elbow</span><span class="p">,</span>      <span class="n">pt2</span><span class="o">=</span><span class="n">tip_of_right_hand</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">],</span>     <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">left_elbow</span><span class="p">,</span>       <span class="n">pt2</span><span class="o">=</span><span class="n">tip_of_left_hand</span><span class="p">,</span>   <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">],</span>     <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">base_of_spine</span><span class="p">,</span>    <span class="n">pt2</span><span class="o">=</span><span class="n">left_foot</span><span class="p">,</span>          <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;magenta&#39;</span><span class="p">],</span>    <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">base_of_spine</span><span class="p">,</span>    <span class="n">pt2</span><span class="o">=</span><span class="n">right_foot</span><span class="p">,</span>         <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;magenta&#39;</span><span class="p">],</span>    <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>  

    <span class="k">return</span> <span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># draw line (full joints: 25)</span>
<span class="k">def</span> <span class="nf">draw_line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">):</span>
    <span class="c1">## Args</span>
    <span class="n">connects</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>\
                                <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>\
                                <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span>\
                                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>\
                                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>  <span class="c1"># 논문 기준 (1 ~ 25)</span>
    
    <span class="n">rgbcodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;magenta&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">custom_thick</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">connects</span><span class="p">):</span>
        <span class="c1"># args</span>
        <span class="n">former</span><span class="p">:</span><span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="n">idx1</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="n">idx1</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>   <span class="c1"># list index에 맞게 idx1 -1</span>
        <span class="n">latter</span><span class="p">:</span><span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="n">idx2</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="n">idx2</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>   <span class="c1"># list index에 맞게 idx2 -1</span>
        
        <span class="c1"># draw</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pt1</span><span class="o">=</span><span class="n">former</span><span class="p">,</span> <span class="n">pt2</span><span class="o">=</span><span class="n">latter</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">rgbcodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">custom_thick</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># draw_line(img, Xs, Ys)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># to prevent kernel crash</span>

<span class="c1"># cv2.imshow(&#39;plotting canvas&#39;, img)      # plotting canvas 창에 이미지 표시</span>
<span class="c1"># cv2.waitKey(0)                          # 아무 키나 누르면</span>
<span class="c1"># cv2.destroyAllWindows()                 # 모든 창 닫기</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PATH_images</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./plotting/images/</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">/&quot;</span>
<span class="n">PATH_gifs</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./plotting/gifs/&quot;</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">PATH_images</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">PATH_gifs</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 프레임 생성</span>
<span class="k">for</span> <span class="n">next_frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SAMPLE</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()):</span>
    <span class="c1"># [NOTE] Global Var</span>
    <span class="c1"># start frame = 1, dontknow = 0</span>
    <span class="c1"># target_joints = [&#39;base of spine&#39;, &#39;middle of spine&#39;, &#39;spine&#39;, &#39;head&#39;,&#39;right elbow&#39;, &#39;left elbow&#39;, &#39;tip of left hand&#39;, &#39;tip of right hand&#39;,&#39;right foot&#39;, &#39;left foot&#39;]     # temp selection</span>
    
    <span class="n">Xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">X</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span> 
    <span class="n">Ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Y</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="p">[</span><span class="n">SAMPLE</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="p">)][</span><span class="n">dontknow</span><span class="p">][</span><span class="n">joint_number</span><span class="p">][</span><span class="n">Z</span><span class="p">]</span> <span class="k">for</span> <span class="n">joint_number</span> <span class="ow">in</span> <span class="n">joint_numbers</span><span class="p">]</span>
    
    <span class="c1"># draw line</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">canvas_shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>    <span class="c1"># 매번 초기화</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">draw_line</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">)</span>
    <span class="n">rgb_result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">PATH_images</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">start_frame</span><span class="o">+</span><span class="n">next_frame</span><span class="si">}</span><span class="s1">.jpg&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PATH_images</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">PATH_images</span><span class="p">)]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]</span>

<span class="n">imageio</span><span class="o">.</span><span class="n">mimsave</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">PATH_gifs</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">check_label</span><span class="p">(</span><span class="n">sample_number</span><span class="o">=</span><span class="n">SAMPLE_NUMBER</span><span class="p">)</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">Xs</span><span class="p">)</span><span class="si">}</span><span class="s1">.gif&#39;</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NTU-RGB+D">NTU RGB+D<a class="anchor-link" href="#NTU-RGB+D"> </a></h3><table>
<thead><tr>
<th style="text-align:center">임의의 joint 10개 추출</th>
<th style="text-align:center">25개 joint 전부 Plotting</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S001C001P001R001A001</td>
<td style="text-align:center">drink water</td>
</tr>
<tr>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933584-6097f7b1-019b-4048-8307-7a2fc20430a8.gif" alt="S001C001P001R001A001_drink_water"></td>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933606-b68bb516-8085-4b70-be0e-74e8de97ab8a.gif" alt="S001C001P001R001A001_drink_water_25"></td>
</tr>
<tr>
<td style="text-align:center">S001C001P001R001A002</td>
<td style="text-align:center">eat_meal/snack</td>
</tr>
<tr>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933618-b906ff57-46b9-4434-b3e0-de424a059443.gif" alt="S001C001P001R001A002_eat_meal_snack"></td>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933612-6d9b6d29-aacf-4cd8-9152-f274f1a96a15.gif" alt="S001C001P001R001A002_eat_meal_snack_25"></td>
</tr>
<tr>
<td style="text-align:center">S001C001P001R001A003</td>
<td style="text-align:center">brushing_teeth</td>
</tr>
<tr>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933626-680cc642-a086-46d0-8daf-d3db84461ac3.gif" alt="S001C001P001R001A003_brushing_teeth"></td>
<td style="text-align:center"><img src="https://user-images.githubusercontent.com/60145951/209933622-5522f337-efc1-405b-abc8-b522669d4aa4.gif" alt="S001C001P001R001A003_brushing_teeth_25"></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
 

